(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[1],{

/***/ "./index.js":
/*!******************!*\
  !*** ./index.js ***!
  \******************/
/*! exports provided: stats_updated */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"stats_updated\", function() { return stats_updated; });\n/* harmony import */ var _roguewasm__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./roguewasm */ \"./roguewasm.js\");\n/***\n * Excerpted from \"Programming WebAssembly with Rust\",\n * published by The Pragmatic Bookshelf.\n * Copyrights apply to this code. It may not be used to create training material,\n * courses, books, articles, and the like. Contact us if you are in doubt.\n * We make no guarantees that this code is fit for any purpose.\n * Visit http://www.pragmaticprogrammer.com/titles/khrust for more book information.\n***/\n\n\n\nvar Game = {\n    display: null,\n    engine: null,\n    player: null,\n    enemy: null,\n\n    init: function () {\n        //        this.display = new ROT.Display();\n        this.display = new ROT.Display({ width: 125, height: 40 })\n        document.getElementById(\"rogueCanvas\").appendChild(this.display.getContainer());\n\n        this.engine = new _roguewasm__WEBPACK_IMPORTED_MODULE_0__[\"Engine\"](this.display);\n        this.generateMap();\n\n        var scheduler = new ROT.Scheduler.Simple();\n\n        scheduler.add(this.player, true);\n        scheduler.add(this.enemy, true);\n\n        this.rotengine = new ROT.Engine(scheduler);\n        this.rotengine.start();\n    },\n\n    generateMap: function () {\n        var digger = new ROT.Map.Digger();\n        var freeCells = [];\n\n        var digCallback = function (x, y, value) {\n            if (!value) {\n                var key = x + \",\" + y;\n                freeCells.push(key);\n            }\n            this.engine.on_dig(x, y, value); //(1)\n        }\n        digger.create(digCallback.bind(this));\n\n        this.generateBoxes(freeCells);\n        this.engine.draw_map(); //(2)\n\n        this.player = this._createBeing(Player, freeCells); // (3)\n        this.enemy = this._createBeing(Checko, freeCells);\n    },\n\n\n    generateBoxes: function (freeCells) {\n        for (var i = 0; i < 10; i++) {\n            var index = Math.floor(ROT.RNG.getUniform() * freeCells.length);\n            var key = freeCells.splice(index, 1)[0];\n            var parts = key.split(\",\");\n            var x = parseInt(parts[0]);\n            var y = parseInt(parts[1]);\n            this.engine.place_box(x, y);\n            if (i == 9) {\n                this.engine.mark_wasmprize(x, y);\n            }\n        }\n    },\n\n    generatePlayer: function (freeCells) {\n        var index = Math.floor(ROT.RNG.getUniform() * freeCells.length);\n        var key = freeCells.splice(index, 1)[0];\n        var parts = key.split(\",\");\n        var x = parseInt(parts[0]);\n        var y = parseInt(parts[1]);\n\n        console.log(\"Generating player...\");\n        this.player = new Player(x, y);\n    },\n};\n\nGame._createBeing = function (what, freeCells) {\n    var index = Math.floor(ROT.RNG.getUniform() * freeCells.length);\n    var key = freeCells.splice(index, 1)[0];\n    var parts = key.split(\",\");\n    var x = parseInt(parts[0]);\n    var y = parseInt(parts[1]);\n    return new what(x, y);\n}\n\n// Checko the Borrow Checker! Run away!\nvar Checko = function (x, y) {\n    this._core = new _roguewasm__WEBPACK_IMPORTED_MODULE_0__[\"PlayerCore\"](x, y, \"B\", \"red\", Game.display);\n    this._core.draw();\n\n    Checko.prototype.act = function () {\n        var x = Game.player.getX();\n        var y = Game.player.getY();\n\n        var passableCallback = function (x, y) {\n            return Game.engine.free_cell(x, y);\n        }\n        var astar = new ROT.Path.AStar(x, y, passableCallback, { topology: 4 });\n\n        var path = [];\n        var pathCallback = function (x, y) {\n            path.push([x, y]);\n        }\n        astar.compute(this._core.x(), this._core.y(), pathCallback);\n\n        path.shift();\n        if (path.length <= 1) {\n            Game.rotengine.lock();\n            alert(\"Game over - you were captured by the Borrow Checker!!\");\n        } else {\n            x = path[0][0];\n            y = path[0][1];\n            Game.engine.move_player(this._core, x, y);\n        }\n    }\n}\n\nvar Player = function (x, y) {\n    this._core = new _roguewasm__WEBPACK_IMPORTED_MODULE_0__[\"PlayerCore\"](x, y, \"@\", \"#ff0\", Game.display);\n    this._core.draw();\n}\n\nPlayer.prototype.act = function () {\n    Game.rotengine.lock();\n    window.addEventListener(\"keydown\", this);\n}\n\nPlayer.prototype.handleEvent = function (e) {\n    var keyMap = {};\n    keyMap[38] = 0;\n    keyMap[33] = 1;\n    keyMap[39] = 2;\n    keyMap[34] = 3;\n    keyMap[40] = 4;\n    keyMap[35] = 5;\n    keyMap[37] = 6;\n    keyMap[36] = 7;\n\n    var code = e.keyCode;\n\n    if (code == 13 || code == 32) {\n        Game.engine.open_box(this._core, this._core.x(), this._core.y());\n        return;\n    }\n\n    /* one of numpad directions? */\n    if (!(code in keyMap)) { return; }\n\n    /* is there a free space? */\n    var dir = ROT.DIRS[8][keyMap[code]];\n    var newX = this._core.x() + dir[0];\n    var newY = this._core.y() + dir[1];\n\n    if (!Game.engine.free_cell(newX, newY)) { return; };\n\n    Game.engine.move_player(this._core, newX, newY);\n    window.removeEventListener(\"keydown\", this);\n    Game.rotengine.unlock();\n}\n\nPlayer.prototype.getX = function () { return this._core.x(); }\n\nPlayer.prototype.getY = function () { return this._core.y(); }\n\nGame.init();\n\nfunction stats_updated(stats) {\n    document.getElementById(\"hitpoints\").textContent = stats.hitpoints;\n    document.getElementById(\"max_hitpoints\").textContent = stats.max_hitpoints;\n    document.getElementById(\"moves\").textContent = stats.moves;\n}\n\n\n//# sourceURL=webpack:///./index.js?");

/***/ }),

/***/ "./roguewasm.js":
/*!**********************!*\
  !*** ./roguewasm.js ***!
  \**********************/
/*! exports provided: __wbg_alert_29e72f16952538bc, __wbg_statsupdated_2d37896afd8a525f, __wbg_draw_8e7a66b23870be01, __wbg_draw_08a30a76a54265c7, Engine, PlayerCore, __wbindgen_object_drop_ref, __wbindgen_json_parse, __wbindgen_throw */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"__wbg_alert_29e72f16952538bc\", function() { return __wbg_alert_29e72f16952538bc; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"__wbg_statsupdated_2d37896afd8a525f\", function() { return __wbg_statsupdated_2d37896afd8a525f; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"__wbg_draw_8e7a66b23870be01\", function() { return __wbg_draw_8e7a66b23870be01; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"__wbg_draw_08a30a76a54265c7\", function() { return __wbg_draw_08a30a76a54265c7; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Engine\", function() { return Engine; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PlayerCore\", function() { return PlayerCore; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"__wbindgen_object_drop_ref\", function() { return __wbindgen_object_drop_ref; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"__wbindgen_json_parse\", function() { return __wbindgen_json_parse; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"__wbindgen_throw\", function() { return __wbindgen_throw; });\n/* harmony import */ var _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./roguewasm_bg */ \"./roguewasm_bg.wasm\");\n/* harmony import */ var _index__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index */ \"./index.js\");\n/***\n * Excerpted from \"Programming WebAssembly with Rust\",\n * published by The Pragmatic Bookshelf.\n * Copyrights apply to this code. It may not be used to create training material,\n * courses, books, articles, and the like. Contact us if you are in doubt.\n * We make no guarantees that this code is fit for any purpose.\n * Visit http://www.pragmaticprogrammer.com/titles/khrust for more book information.\n***/\n/* tslint:disable */\n\n\n\nconst lTextDecoder = typeof TextDecoder === 'undefined' ? __webpack_require__(/*! util */ \"./node_modules/util/util.js\").TextDecoder : TextDecoder;\n\nlet cachedTextDecoder = new lTextDecoder('utf-8');\n\nlet cachegetUint8Memory = null;\nfunction getUint8Memory() {\n    if (cachegetUint8Memory === null || cachegetUint8Memory.buffer !== _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"memory\"].buffer) {\n        cachegetUint8Memory = new Uint8Array(_roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"memory\"].buffer);\n    }\n    return cachegetUint8Memory;\n}\n\nfunction getStringFromWasm(ptr, len) {\n    return cachedTextDecoder.decode(getUint8Memory().subarray(ptr, ptr + len));\n}\n\nfunction __wbg_alert_29e72f16952538bc(arg0, arg1) {\n    let varg0 = getStringFromWasm(arg0, arg1);\n    alert(varg0);\n}\n\nconst heap = new Array(32);\n\nheap.fill(undefined);\n\nheap.push(undefined, null, true, false);\n\nfunction getObject(idx) { return heap[idx]; }\n\nlet heap_next = heap.length;\n\nfunction dropObject(idx) {\n    if (idx < 36) return;\n    heap[idx] = heap_next;\n    heap_next = idx;\n}\n\nfunction takeObject(idx) {\n    const ret = getObject(idx);\n    dropObject(idx);\n    return ret;\n}\n\nfunction __wbg_statsupdated_2d37896afd8a525f(arg0) {\n    Object(_index__WEBPACK_IMPORTED_MODULE_1__[\"stats_updated\"])(takeObject(arg0));\n}\n\nfunction __wbg_draw_8e7a66b23870be01(arg0, arg1, arg2, arg3, arg4) {\n    let varg3 = getStringFromWasm(arg3, arg4);\n    getObject(arg0).draw(arg1, arg2, varg3);\n}\n\nfunction __wbg_draw_08a30a76a54265c7(arg0, arg1, arg2, arg3, arg4, arg5, arg6) {\n    let varg3 = getStringFromWasm(arg3, arg4);\n    let varg5 = getStringFromWasm(arg5, arg6);\n    getObject(arg0).draw(arg1, arg2, varg3, varg5);\n}\n\nconst lTextEncoder = typeof TextEncoder === 'undefined' ? __webpack_require__(/*! util */ \"./node_modules/util/util.js\").TextEncoder : TextEncoder;\n\nlet cachedTextEncoder = new lTextEncoder('utf-8');\n\nlet WASM_VECTOR_LEN = 0;\n\nfunction passStringToWasm(arg) {\n\n    const buf = cachedTextEncoder.encode(arg);\n    const ptr = _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"__wbindgen_malloc\"](buf.length);\n    getUint8Memory().set(buf, ptr);\n    WASM_VECTOR_LEN = buf.length;\n    return ptr;\n}\n\nfunction addHeapObject(obj) {\n    if (heap_next === heap.length) heap.push(heap.length + 1);\n    const idx = heap_next;\n    heap_next = heap[idx];\n\n    heap[idx] = obj;\n    return idx;\n}\n\nfunction freeEngine(ptr) {\n\n    _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"__wbg_engine_free\"](ptr);\n}\n/**\n*/\nclass Engine {\n\n    free() {\n        const ptr = this.ptr;\n        this.ptr = 0;\n        freeEngine(ptr);\n    }\n\n    /**\n    * @param {any} arg0\n    * @returns {}\n    */\n    constructor(arg0) {\n        this.ptr = _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"engine_new\"](addHeapObject(arg0));\n    }\n    /**\n    * @param {number} arg0\n    * @param {number} arg1\n    * @param {number} arg2\n    * @returns {void}\n    */\n    on_dig(arg0, arg1, arg2) {\n        return _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"engine_on_dig\"](this.ptr, arg0, arg1, arg2);\n    }\n    /**\n    * @returns {void}\n    */\n    draw_map() {\n        return _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"engine_draw_map\"](this.ptr);\n    }\n    /**\n    * @param {number} arg0\n    * @param {number} arg1\n    * @returns {void}\n    */\n    redraw_at(arg0, arg1) {\n        return _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"engine_redraw_at\"](this.ptr, arg0, arg1);\n    }\n    /**\n    * @param {number} arg0\n    * @param {number} arg1\n    * @returns {void}\n    */\n    place_box(arg0, arg1) {\n        return _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"engine_place_box\"](this.ptr, arg0, arg1);\n    }\n    /**\n    * @param {PlayerCore} arg0\n    * @param {number} arg1\n    * @param {number} arg2\n    * @returns {void}\n    */\n    open_box(arg0, arg1, arg2) {\n        return _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"engine_open_box\"](this.ptr, arg0.ptr, arg1, arg2);\n    }\n    /**\n    * @param {number} arg0\n    * @param {number} arg1\n    * @returns {void}\n    */\n    mark_wasmprize(arg0, arg1) {\n        return _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"engine_mark_wasmprize\"](this.ptr, arg0, arg1);\n    }\n    /**\n    * @param {PlayerCore} arg0\n    * @param {number} arg1\n    * @param {number} arg2\n    * @returns {void}\n    */\n    move_player(arg0, arg1, arg2) {\n        return _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"engine_move_player\"](this.ptr, arg0.ptr, arg1, arg2);\n    }\n    /**\n    * @param {number} arg0\n    * @param {number} arg1\n    * @returns {boolean}\n    */\n    free_cell(arg0, arg1) {\n        return (_roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"engine_free_cell\"](this.ptr, arg0, arg1)) !== 0;\n    }\n}\n\nfunction freePlayerCore(ptr) {\n\n    _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"__wbg_playercore_free\"](ptr);\n}\n/**\n*/\nclass PlayerCore {\n\n    free() {\n        const ptr = this.ptr;\n        this.ptr = 0;\n        freePlayerCore(ptr);\n    }\n\n    /**\n    * @param {number} arg0\n    * @param {number} arg1\n    * @param {string} arg2\n    * @param {string} arg3\n    * @param {any} arg4\n    * @returns {}\n    */\n    constructor(arg0, arg1, arg2, arg3, arg4) {\n        const ptr2 = passStringToWasm(arg2);\n        const len2 = WASM_VECTOR_LEN;\n        const ptr3 = passStringToWasm(arg3);\n        const len3 = WASM_VECTOR_LEN;\n        try {\n            this.ptr = _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"playercore_new\"](arg0, arg1, ptr2, len2, ptr3, len3, addHeapObject(arg4));\n\n        } finally {\n            _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"__wbindgen_free\"](ptr2, len2 * 1);\n            _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"__wbindgen_free\"](ptr3, len3 * 1);\n\n        }\n\n    }\n    /**\n    * @returns {number}\n    */\n    x() {\n        return _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"playercore_x\"](this.ptr);\n    }\n    /**\n    * @returns {number}\n    */\n    y() {\n        return _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"playercore_y\"](this.ptr);\n    }\n    /**\n    * @returns {void}\n    */\n    draw() {\n        return _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"playercore_draw\"](this.ptr);\n    }\n    /**\n    * @param {number} arg0\n    * @param {number} arg1\n    * @returns {void}\n    */\n    move_to(arg0, arg1) {\n        return _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"playercore_move_to\"](this.ptr, arg0, arg1);\n    }\n    /**\n    * @returns {void}\n    */\n    emit_stats() {\n        return _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"playercore_emit_stats\"](this.ptr);\n    }\n    /**\n    * @param {number} arg0\n    * @returns {number}\n    */\n    take_damage(arg0) {\n        return _roguewasm_bg__WEBPACK_IMPORTED_MODULE_0__[\"playercore_take_damage\"](this.ptr, arg0);\n    }\n}\n\nfunction __wbindgen_object_drop_ref(i) { dropObject(i); }\n\nfunction __wbindgen_json_parse(ptr, len) {\n    return addHeapObject(JSON.parse(getStringFromWasm(ptr, len)));\n}\n\nfunction __wbindgen_throw(ptr, len) {\n    throw new Error(getStringFromWasm(ptr, len));\n}\n\n\n\n//# sourceURL=webpack:///./roguewasm.js?");

/***/ }),

/***/ "./roguewasm_bg.wasm":
/*!***************************!*\
  !*** ./roguewasm_bg.wasm ***!
  \***************************/
/*! exports provided: memory, __rustc_debug_gdb_scripts_section__, __wbg_playercore_free, playercore_new, playercore_x, playercore_y, playercore_draw, playercore_move_to, playercore_emit_stats, playercore_take_damage, __wbg_engine_free, engine_new, engine_on_dig, engine_draw_map, engine_redraw_at, engine_place_box, engine_open_box, engine_mark_wasmprize, engine_move_player, engine_free_cell, __wbindgen_malloc, __wbindgen_free */
/***/ (function(module, exports, __webpack_require__) {

eval("\"use strict\";\n// Instantiate WebAssembly module\nvar wasmExports = __webpack_require__.w[module.i];\n__webpack_require__.r(exports);\n// export exports from WebAssembly module\nfor(var name in wasmExports) if(name != \"__webpack_init__\") exports[name] = wasmExports[name];\n// exec imports from WebAssembly module (for esm order)\n/* harmony import */ var m0 = __webpack_require__(/*! ./roguewasm */ \"./roguewasm.js\");\n\n\n// exec wasm module\nwasmExports[\"__webpack_init__\"]()\n\n//# sourceURL=webpack:///./roguewasm_bg.wasm?");

/***/ })

}]);